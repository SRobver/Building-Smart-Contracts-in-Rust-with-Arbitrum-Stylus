# DemoNFT Contract with Arbitrum Stylus

## Introduction

Welcome to this comprehensive tutorial on building a complete NFT (ERC-721) smart contract ecosystem using Rust and Arbitrum Stylus. This project demonstrates professional smart contract development practices, from contract implementation to frontend integration.

In this guide, we'll build a demo ERC-721 non-fungible token contract that supports standard NFT operations: minting, transferring, approving, and querying token ownership. We'll also create a complete web3 frontend to interact with the contract, providing a full-stack demonstration of modern dApp development.

**What This Project Builds:**

- **DemoNFT Smart Contract:** A standards-compliant ERC-721 implementation in Rust
- **Web3 Frontend:** A responsive interface for minting and managing NFTs
- **Local Development Setup:** Complete testing environment with Arbitrum Nitro devnode
- **Production Best Practices:** Type safety, access control, and gas optimization

**ERC-721 Standard Overview:**
ERC-721 is the Ethereum standard for non-fungible tokens. Each token is unique and represents ownership of a distinct digital asset. Unlike ERC-20 (fungible) tokens that are interchangeable, ERC-721 tokens are perfect for:

- Digital collectibles
- Virtual real estate
- Gaming assets
- Identity verification
- Any application requiring unique, provably scarce digital items

This tutorial bridges the gap between blockchain backend development and frontend user experience, giving you the tools to build production-ready NFT applications.

**Why Rust + Stylus for NFTs:**

- **Type Safety:** Compile-time guarantees prevent common vulnerabilities
- **Performance:** WebAssembly execution is up to 50% cheaper than Solidity
- **Maintainability:** Strong ownership model and modular architecture
- **Interoperability:** Seamless integration with existing Ethereum tooling

## Getting Started

### Prerequisites

- Rust toolchain
- VS Code
- Docker
- Foundry's cast
- Nitro devnode

### Installation

1. Install the Stylus CLI:

```bash
cargo install --force cargo-stylus
```

2. Enable WebAssembly compilation:

```bash
rustup default 1.80
rustup target add wasm32-unknown-unknown --toolchain 1.80
```

3. Verify installation:

```bash
cargo stylus --help
```

4. Clone the main repository:

```bash
git clone https://github.com/SRobver/Building-Smart-Contracts-in-Rust-with-Arbitrum-Stylus.git && cd nft-dapp
```

## Testnet Details

Find all necessary testnet resources—faucets, RPC URLs, etc.—[here](https://docs.arbitrum.io/stylus/reference/testnet-information).

## Contract Validation

Before deploying, validate your contract can be deployed and activated onchain:

```bash
cargo stylus check
```

Docker must be running for this command.

Example successful output:

```
Finished release [optimized] target(s) in 1.88s
Reading WASM file at nft-dapp/target/wasm32-unknown-unknown/release/nft_dapp.wasm
Compressed WASM size: XX KB
Program succeeded Stylus onchain activation checks with Stylus version: 1
```

## Contract Deployment

### 1. Estimate Gas (without transaction)

```bash
cargo stylus deploy \
  --private-key-path=<PRIVKEY_FILE_PATH> \
  --estimate-gas
```

Example output:

```
Estimated gas for deployment: 1973450
```

### 2. Deploy Contract

```bash
cargo stylus deploy \
  --private-key-path=<PRIVKEY_FILE_PATH>
```

Successful output:

```
Compressed WASM size: XX KB
Deploying program to address 0x457b1ba688e9854bdbed2f473f7510c476a3da09
Estimated gas: 1973450
Submitting tx...
Confirmed tx 0x42db…7311, gas used 1973450
Activating program at address 0x457b1ba688e9854bdbed2f473f7510c476a3da09
Estimated gas: 14044638
Submitting tx...
Confirmed tx 0x0bdb…3307, gas used 14044638
```

Your contract is now deployed and activated!

## ABI Generation

Generate the Solidity ABI for your contract:

```bash
cargo stylus export-abi
```

This will output:

```solidity
/**
 * This file was automatically generated by Stylus and represents a Rust program.
 * For more information, please see [The Stylus SDK](https://github.com/OffchainLabs/stylus-sdk-rs).
 */

// SPDX-License-Identifier: MIT-OR-APACHE-2.0
pragma solidity ^0.8.23;

interface IDemoNFT {
    function name() external view returns (string memory);
    function symbol() external view returns (string memory);
    function ownerOf(uint256 tokenId) external view returns (address);
    function balanceOf(address owner) external view returns (uint256);
    function mint(address to, uint256 tokenId) external;
    function transferFrom(address from, address to, uint256 tokenId) external;
    function approve(address spender, uint256 tokenId) external;
}
```

## Interacting with the Contract

### Rust Interaction Example

See `examples/nft.rs` for a complete example using ethers-rs:

```rust
abigen!(
    DemoNFT,
    r#"[
        function name() external view returns (string memory)
        function symbol() external view returns (string memory)
        function ownerOf(uint256 tokenId) external view returns (address)
        function balanceOf(address owner) external view returns (uint256)
        function mint(address to, uint256 tokenId) external
        function transferFrom(address from, address to, uint256 tokenId) external
        function approve(address spender, uint256 tokenId) external
    ]"#
);

// Configure environment with:
// RPC_URL, STYLUS_CONTRACT_ADDRESS, PRIV_KEY_PATH
// in a .env file or environment variables

let provider = alchemy_provider(&rpc_url).await?;
let client = LocalWallet::from_str(&priv_key, &provider.clone())?;
let nft = DemoNFT::new(nft_address, &provider.into());

// Read NFT metadata
let name = nft.name().call().await?;
println!("NFT name: {}", name);

// Mint an NFT
let token_id = U256::from(1);
let _ = nft.mint(client.address(), token_id).send().await?.await?;
println!("Minted token {}", token_id);

// Check ownership
let owner = nft.owner_of(token_id).call().await?;
println!("Owner of token {}: {:?}", token_id, owner);
```

Run with:

```bash
cargo run --example nft
```

### Foundry's Cast

#### Calling a Function

```bash
cast call \
  --rpc-url <RPC_URL> \
  --private-key <PRIVATE_KEY> \
  [contract-address] "name()(string)"
```

Example output:

```
DemoNFT
```

#### Sending a Transaction (Mint NFT)

```bash
cast send \
  --rpc-url <RPC_URL> \
  --private-key <PRIVATE_KEY> \
  [contract-address] "mint(address,uint256)" <YOUR_ADDRESS> 1
```

After minting, you can call functions like balanceOf or ownerOf to verify.

## Testing

The template includes test files that demonstrate how to test your Stylus NFT contract:

Run tests with:

```bash
cargo test
```

## Customization Options

- Add dependencies in `Cargo.toml` for advanced features
- Use `cargo stylus new --minimal` for a leaner setup
